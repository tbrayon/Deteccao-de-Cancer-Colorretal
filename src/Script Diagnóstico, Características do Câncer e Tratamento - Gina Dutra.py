# -*- coding: utf-8 -*-
"""Projeto C√¢ncer Colorretal

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KsdB73EGE2Idcq7SUREpyqocS8nYjoU9

**1) An√°lise Inicial: Estrutura dos Dados**
"""

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import textwrap
from scipy.stats import chi2_contingency
import numpy as np
from scipy.stats import spearmanr
import statsmodels.api as sm
#from google.colab import drive

# Conectar o Google Drive ao ambiente do Colab.
#drive.mount('/content/drive')

# Defina o caminho correto para o arquivo no Google Colab
file_path = "c:/Users/gina_/OneDrive/√Årea de Trabalho/PUC/AULAS 7 SEMESTRE/Projeto/colorectal_cancer_prediction.xlsx"

# Carregar o dataset diretamente usando pandas
df = pd.read_excel(file_path, dtype=str)

# Dimens√µes do DataFrame (quantidade de linhas e colunas).
print(df.shape)

# Lista todas as colunas do dataframe
# Imprime o √≠ndice das colunas
print(df.columns)
# Remove espa√ßos em branco (tanto √† esquerda quanto √† direita) dos nomes das colunas
df.columns = df.columns.str.strip()
# Converte o √≠ndice das colunas do DataFrame df em uma lista Python e a imprime
print(df.columns.tolist())
# Imprime o √≠ndice das linhas
print(df.index)
# Reseta o √≠ndice do DataFrame df para o padr√£o (uma sequ√™ncia de n√∫meros inteiros come√ßando em 0) e remove o √≠ndice antigo
df = df.reset_index(drop=True)
# Mostra o tipo de informa√ß√£o que cada coluna cont√©m (n√∫meros, texto, etc.).
print(df.dtypes)

# Exibir as primeiras 5 linhas com todas as colunas
print("First 5 records with all 30 columns:")
print(df.head())

# Verificar as informa√ß√µes do dataset (tipos de dados, valores nulos, etc.)
print(df.info())

# Verificar quantas linhas est√£o completamente vazias. (N√£o h√° nenhuma linha vazia)
print(df[df.isnull().all(axis=1)])

# Exibir todas as linhas onde todos os valores s√£o NaN. (Todas as linhas do DataFrame possuem pelo menos um valor preenchido)
print((df.isnull().any(axis=1)).sum())

# Print de verifica√ß√£o de valores ausentes. (N√£o h√° valor ausente)
print(df.isnull().sum())

"""**2) Transformando os dados categ√≥ricos em num√©ricos na categoria "Diagn√≥stico, Caracter√≠sticas do C√¢ncer e Tratamento" e nas colunas Age e Time_to_Recurrence:**"""

# Coluna Stage_at_Diagnosi:
# Descri√ß√£o: Est√°gio do c√¢ncer no momento do diagn√≥stico.
stage_mapping = {"I": 1, "II": 2, "III": 3, "IV": 4}
df["Stage_at_Diagnosis"] = df["Stage_at_Diagnosis"].map(stage_mapping)
df.replace({"Stage_at_Diagnosis": stage_mapping}, inplace=True)
print(df["Stage_at_Diagnosis"].head)

# Coluna Tumor_Aggressiveness:
# Descri√ß√£o: N√≠vel de agressividade do tumor.
tumor_mapping = {"Low": 1, "Medium": 2, "High": 3}
df["Tumor_Aggressiveness"] = df["Tumor_Aggressiveness"].map(tumor_mapping)
df.replace({"Tumor_Aggressiveness": stage_mapping}, inplace=True)
print(df["Tumor_Aggressiveness"].head)

# Coluna Insurance_Coverage
# Descri√ß√£o: Paciente possui plano de sa√∫de.
insurance_mapping = {"Yes": 1, "No": 0}
df["Insurance_Coverage"] = df["Insurance_Coverage"].map(insurance_mapping)
df.replace({"Insurance_Coverage": insurance_mapping}, inplace=True)
print(df["Insurance_Coverage"].head)

# Coluna Time_to_Diagnosis
# Descri√ß√£o: Tempo decorrido entre os primeiros sintomas e o diagn√≥stico.
time_to_diagnosis_mapping = {"Delayed": 2, "Timely": 1}
df["Time_to_Diagnosis"] = df["Time_to_Diagnosis"].map(time_to_diagnosis_mapping)
df.replace({"Time_to_Diagnosis": time_to_diagnosis_mapping}, inplace=True)
print(df["Time_to_Diagnosis"].head)

# Coluna Treatment_Access
# Descri√ß√£o: N√≠vel de acesso ao tratamento.
treatment_access_mapping = {"Good": 1, "Limited": 2}
df["Treatment_Access"] = df["Treatment_Access"].map(treatment_access_mapping)
df.replace({"Treatment_Access": treatment_access_mapping}, inplace=True)
print(df["Treatment_Access"].head)

# Coluna Chemotherapy_Received
# Descri√ß√£o: O paciente realizou quimioterapia?
chemotherapy_mapping = {"Yes": 1, "No": 0}
df["Chemotherapy_Received"] = df["Chemotherapy_Received"].map(chemotherapy_mapping)
df.replace({"Chemotherapy_Received": chemotherapy_mapping}, inplace=True)
print(df["Chemotherapy_Received"].head)

# Coluna Radiotherapy_Received
# Descri√ß√£o: O paciente realizou radioterapia?
radiotherapy_mapping = {"Yes": 1, "No": 0}
df["Radiotherapy_Received"] = df["Radiotherapy_Received"].map(radiotherapy_mapping)
df.replace({"Radiotherapy_Received": radiotherapy_mapping}, inplace=True)
print(df["Radiotherapy_Received"].head)

# Coluna Age (Idade)
# Descri√ß√£o: Idade do paciente em anos.
df["Age"] = pd.to_numeric(df["Age"], errors="coerce")
# Ver se tem algum NaN
print(df["Age"].isnull().sum())
print(df[df["Age"].isnull()])
print(df["Age"].head)

# Coluna Time_to_Recurrence (Tempo at√© a Recorr√™ncia)
# Descri√ß√£o: Tempo decorrido at√© a recorr√™ncia do c√¢ncer (em meses).
df["Time_to_Recurrence"] = pd.to_numeric(df["Time_to_Recurrence"], errors="coerce")
# Ver se tem algum NaN
print(df["BMI"].isnull().sum())
print(df["Time_to_Recurrence"].head)

# Coluna Colonoscopy_Access (Acesso √† Colonoscopia)
# Descri√ß√£o: Paciente teve acesso √† colonoscopia para rastreamento?
colonoscopy_mapping = {"Yes": 1, "No": 0}
df["Colonoscopy_Access"] = df["Colonoscopy_Access"].map(colonoscopy_mapping)
df.replace({"Colonoscopy_Access": colonoscopy_mapping}, inplace=True)
print(df["Colonoscopy_Access"].head())

# Verificando se as colunas acima foram transformadas em num√©ricos.
print(df.info())

# Printando as colunas para ver se est√° tudo certo no dataset.
print(df.head())

"""**3) Analisando cada coluna separadamente na categoria "Diagn√≥stico, Caracter√≠sticas do C√¢ncer e Tratamento":**


"""

# Gr√°fico de barras para a distribui√ß√£o dos est√°gios do diagn√≥stico

# Contagem dos valores
counts = df["Stage_at_Diagnosis"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Distribui√ß√£o de Est√°gios no Diagn√≥stico", color='royalblue')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Est√°gio")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1, 2, 3], labels=["II", "I", "III", "IV"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: Est√°gio do c√¢ncer no momento do diagn√≥stico.", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa, com espa√ßo entre as caixas)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "I: Tumor localizado, sem dissemina√ß√£o\n"
    "II: Tumor invadiu tecidos pr√≥ximos\n"
    "III: Tumor com envolvimento significativo dos linfonodos\n"
    "IV: C√¢ncer metast√°tico (espalhado para √≥rg√£os distantes)"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o


plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto6 = (
    "O gr√°fico de barras exibe a distribui√ß√£o dos est√°gios do diagn√≥stico de c√¢ncer, mostrando a frequ√™ncia de pacientes em cada est√°gio. "
    "Observa-se que o est√°gio II √© o mais frequente, seguido pelos est√°gios I e III, que apresentam frequ√™ncias semelhantes. "
    "O est√°gio IV, que representa o c√¢ncer metast√°tico, √© o menos frequente. "
    "Essa distribui√ß√£o pode refletir a preval√™ncia de diferentes est√°gios de c√¢ncer na popula√ß√£o estudada ou as caracter√≠sticas do diagn√≥stico e encaminhamento dos pacientes. "
    "A an√°lise da distribui√ß√£o dos est√°gios do diagn√≥stico pode auxiliar na compreens√£o da progress√£o da doen√ßa e no planejamento de estrat√©gias de tratamento e acompanhamento."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto6, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

# Gr√°fico de barras para a agressividade do tumor

# Contagem dos valores
counts = df["Tumor_Aggressiveness"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Distribui√ß√£o da Agressividade do Tumor", color='firebrick')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Agressividade")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1, 2], labels=["Medium", "Low", "High"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: N√≠vel de agressividade do tumor.", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "Low: Baixa\n"
    "Medium: M√©dia\n"
    "High: Alta"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o


plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto7 = (
    "O gr√°fico de barras exibe a distribui√ß√£o da agressividade do tumor, mostrando a frequ√™ncia de pacientes em cada n√≠vel de agressividade. "
    "Observa-se que a agressividade m√©dia e baixa s√£o as mais frequentes, com frequ√™ncias semelhantes, enquanto a agressividade alta √© a menos frequente. "
    "Essa distribui√ß√£o pode refletir as caracter√≠sticas dos tumores na popula√ß√£o estudada ou os crit√©rios de classifica√ß√£o da agressividade tumoral. "
    "A an√°lise da distribui√ß√£o da agressividade tumoral pode auxiliar na compreens√£o do comportamento dos tumores e no planejamento de estrat√©gias de tratamento e acompanhamento."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto7, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

# Gr√°fico de barras para plano de sa√∫de

# Contagem dos valores
counts = df["Insurance_Coverage"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Cobertura de Plano de Sa√∫de", color='purple')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Possui Plano?")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1], labels=["Sim", "N√£o"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: Paciente possui plano de sa√∫de?", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "Sim: Paciente possui plano de sa√∫de\n"
    "N√£o: Paciente n√£o possui plano de sa√∫de"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o


plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto8 = (
    "O gr√°fico de barras exibe a distribui√ß√£o da cobertura de plano de sa√∫de entre os pacientes. "
    "Observa-se que a maioria dos pacientes possui plano de sa√∫de, com uma frequ√™ncia significativamente maior em compara√ß√£o com aqueles que n√£o possuem. "
    "Essa distribui√ß√£o pode refletir a preval√™ncia de planos de sa√∫de na popula√ß√£o estudada ou os crit√©rios de inclus√£o dos pacientes na an√°lise. "
    "A an√°lise da cobertura de plano de sa√∫de pode auxiliar na compreens√£o do acesso aos servi√ßos de sa√∫de e no planejamento de estrat√©gias de tratamento e acompanhamento."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto8, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

# Gr√°fico de barras para tempo at√© o diagn√≥stico

# Contagem dos valores
counts = df["Time_to_Diagnosis"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Tempo at√© o Diagn√≥stico", color='seagreen')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Tempo")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1], labels=["Timely", "Delayed"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: Tempo decorrido entre os primeiros sintomas e o diagn√≥stico.", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "Delayed: Tardio\n"
    "Timely: Precoce"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o

plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto9 = (
    "O gr√°fico de barras exibe a distribui√ß√£o do tempo at√© o diagn√≥stico, mostrando a frequ√™ncia de pacientes que receberam o diagn√≥stico de forma precoce ou tardia. "
    "Observa-se que a maioria dos pacientes recebeu o diagn√≥stico de forma precoce (Timely), com uma frequ√™ncia significativamente maior em compara√ß√£o com aqueles que receberam o diagn√≥stico de forma tardia (Delayed). "
    "Essa distribui√ß√£o pode refletir a efic√°cia dos sistemas de sa√∫de na detec√ß√£o precoce de doen√ßas ou os crit√©rios de classifica√ß√£o do tempo de diagn√≥stico. "
    "A an√°lise do tempo at√© o diagn√≥stico pode auxiliar na compreens√£o dos fatores que influenciam o diagn√≥stico precoce ou tardio e no planejamento de estrat√©gias de interven√ß√£o."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto9, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

# Gr√°fico de barras para acesso ao tratamento

# Contagem dos valores
counts = df["Treatment_Access"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Acesso ao Tratamento", color='darkorange')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Acesso")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1], labels=["Good", "Limited"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: N√≠vel de acesso ao tratamento.", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "Good: Adequado\n"
    "Limited: Limitado"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o

plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto10 = (
    "O gr√°fico de barras exibe a distribui√ß√£o do n√≠vel de acesso ao tratamento entre os pacientes. "
    "Observa-se que a maioria dos pacientes possui acesso adequado ao tratamento (Good), com uma frequ√™ncia significativamente maior em compara√ß√£o com aqueles que possuem acesso limitado (Limited). "
    "Essa distribui√ß√£o pode refletir a qualidade dos servi√ßos de sa√∫de dispon√≠veis ou os crit√©rios de classifica√ß√£o do acesso ao tratamento. "
    "A an√°lise do n√≠vel de acesso ao tratamento pode auxiliar na compreens√£o das disparidades no acesso aos servi√ßos de sa√∫de e no planejamento de estrat√©gias de interven√ß√£o."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto10, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

# Gr√°fico de barras para quimioterapia recebida

# Contagem dos valores
counts = df["Chemotherapy_Received"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Pacientes que Receberam Quimioterapia", color='dodgerblue')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Quimioterapia")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1], labels=["Sim", "N√£o"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: O paciente realizou quimioterapia?", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "Sim: Paciente realizou quimioterapia\n"
    "N√£o: Paciente n√£o realizou quimioterapia"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o

plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto11 = (
    "O gr√°fico de barras exibe a distribui√ß√£o de pacientes que receberam quimioterapia. "
    "Observa-se que o n√∫mero de pacientes que receberam quimioterapia (Sim) √© ligeiramente superior ao n√∫mero de pacientes que n√£o receberam (N√£o). "
    "Essa distribui√ß√£o pode refletir as caracter√≠sticas da popula√ß√£o estudada ou os protocolos de tratamento adotados. "
    "A an√°lise da frequ√™ncia de pacientes que receberam quimioterapia pode auxiliar na compreens√£o da utiliza√ß√£o desse tipo de tratamento e no planejamento de estrat√©gias de interven√ß√£o."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto11, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

# Gr√°fico de barras para radioterapia recebida

# Contagem dos valores
counts = df["Radiotherapy_Received"].value_counts()
# Criar o gr√°fico de barras
ax = counts.plot(kind="bar", title="Pacientes que Receberam Radioterapia", color='darkred')
# Adicionar r√≥tulos acima das barras
for i, v in enumerate(counts):
    ax.text(i, v + 1, str(v), ha='center', fontsize=10)
plt.xlabel("Radioterapia")
plt.ylabel("Frequ√™ncia")
plt.xticks(ticks=[0, 1], labels=["N√£o", "Sim"], rotation=0)

# Descri√ß√£o (em caixa e alinhada √† esquerda)
plt.figtext(0.01, -0.25, "Descri√ß√£o: O paciente realizou radioterapia?", ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

# Valores poss√≠veis (alinhados e em caixa)
valores_possiveis = (
    "Valores Poss√≠veis:\n"
    "N√£o: Paciente n√£o realizou radioterapia\n"
    "Sim: Paciente realizou radioterapia"
)

plt.figtext(0.01, -0.5, valores_possiveis, ha="left", fontsize=10, bbox={"facecolor":"lightgray", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75]) # Ajusta o layout para evitar sobreposi√ß√£o

plt.show()

# Inserindo um espa√ßo
print("\n")

# Texto explicativo
texto12 = (
    "O gr√°fico de barras exibe a distribui√ß√£o de pacientes que receberam radioterapia. "
    "Observa-se que a maioria dos pacientes n√£o recebeu radioterapia (N√£o), com uma frequ√™ncia significativamente maior em compara√ß√£o com aqueles que receberam (Sim). "
    "Essa distribui√ß√£o pode refletir as caracter√≠sticas da popula√ß√£o estudada ou os protocolos de tratamento adotados. "
    "A an√°lise da frequ√™ncia de pacientes que receberam radioterapia pode auxiliar na compreens√£o da utiliza√ß√£o desse tipo de tratamento e no planejamento de estrat√©gias de interven√ß√£o."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto12, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

plt.show()

"""**4) Realizando an√°lises estat√≠sticas entre a categoria "Diagn√≥stico, Caracter√≠sticas do C√¢ncer e Tratamento" e demais vari√°veis num√©ricas do Dataset (Age e Time To Recurrence):**"""

# Medidas de Tend√™ncia Central e Dispers√£o
print("\nMedidas de Tend√™ncia Central e Dispers√£os:")
estatisticas = df.describe().loc[['mean', '50%', 'std']]  # 50% representa a mediana

# Formata√ß√£o do output para melhor legibilidade
print("\nM√©dias e Medidas de Dispers√£o das Vari√°veis Num√©ricas:\n")
print(estatisticas.to_string())

# Texto explicativo
texto13 = (
    "A an√°lise das medidas de tend√™ncia central e dispers√£o revela insights importantes sobre as vari√°veis num√©ricas do conjunto de dados. A idade m√©dia dos pacientes √© de aproximadamente"
    "54 anos, com uma mediana similar, indicando uma distribui√ß√£o relativamente sim√©trica. O est√°gio m√©dio do diagn√≥stico √© 1.4, sugerindo que a maioria dos pacientes foi diagnosticada em "
    "est√°gios iniciais. A agressividade tumoral m√©dia √© 0.8, com uma mediana de 1, indicando uma tend√™ncia para tumores de baixa agressividade. A maioria dos pacientes possui cobertura de "
    "seguro de sa√∫de, teve diagn√≥stico r√°pido e acesso ao tratamento. A propor√ß√£o de pacientes que receberam quimioterapia e radioterapia √© aproximadamente igual."
    " O tempo m√©dio para recorr√™ncia √© de cerca de 29.5 meses, com uma mediana de 30 meses, sugerindo uma distribui√ß√£o relativamente sim√©trica. O desvio padr√£o para idade e tempo de recorr√™ncia"
    " indicam uma varia√ß√£o consider√°vel entre os pacientes, enquanto as outras vari√°veis mostram menor varia√ß√£o. √â importante notar que algumas vari√°veis, como 'Insurance_Coverage', "
    "'Time_to_Diagnosis', 'Treatment_Access', 'Chemotherapy_Received' e 'Radiotherapy_Received' parecem ser bin√°rias ou ter uma escala limitada, o que explica a baixa variabilidade"
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto13, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

# Resumo estat√≠stico de algumas colunas num√©ricas
resumo_estatistico = df.describe()

# Formata√ß√£o do resumo estat√≠stico para melhor legibilidade
resumo_formatado = resumo_estatistico.to_string()

# Impress√£o do resumo estat√≠stico formatado
print(resumo_formatado)

# Texto explicativo
texto15 = (
    "O resumo estat√≠stico acima apresenta as principais medidas descritivas das vari√°veis num√©ricas do conjunto de dados. A contagem (count) indica o n√∫mero de observa√ß√µes v√°lidas em cada"
    "coluna. A m√©dia (mean) representa o valor m√©dio de cada vari√°vel. O desvio padr√£o (std) mede a dispers√£o dos dados em rela√ß√£o √† m√©dia. O valor m√≠nimo (min) e o valor m√°ximo (max) "
    "indicam os limites da varia√ß√£o de cada vari√°vel. Os quartis (25%, 50%, 75%) dividem os dados em quatro partes iguais, permitindo analisar a distribui√ß√£o dos dados. Observa-se que a"
    "vari√°vel 'Idade' (Age) apresenta uma m√©dia de 54.33 anos, com uma varia√ß√£o consider√°vel (desvio padr√£o de 20.18 anos). A vari√°vel 'Tempo at√© a Recorr√™ncia' (Time_to_Recurrence) "
    "apresenta uma m√©dia de 29.54 meses, com uma varia√ß√£o de at√© 59 meses. As demais vari√°veis, como 'Est√°gio do Diagn√≥stico' (Stage_at_Diagnosis), "
    "'Agressividade do Tumor' (Tumor_Aggressiveness), 'Cobertura do Plano de Sa√∫de' (Insurance_Coverage), 'Tempo at√© o Diagn√≥stico' (Time_to_Diagnosis), "
    "'Acesso ao Tratamento' (Treatment_Access), 'Recebimento de Quimioterapia' (Chemotherapy_Received) e 'Recebimento de Radioterapia' (Radiotherapy_Received),"
    " s√£o vari√°veis categ√≥ricas bin√°rias (0 ou 1), com m√©dias pr√≥ximas de 0.5, indicando uma distribui√ß√£o equilibrada entre as categorias. A an√°lise do resumo estat√≠stico pode auxiliar "
    "na compreens√£o da distribui√ß√£o e varia√ß√£o das vari√°veis num√©ricas, fornecendo informa√ß√µes importantes para a an√°lise explorat√≥ria dos dados e o desenvolvimento de modelos preditivos"
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto15, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

# Medidas de Tend√™ncia Central (M√©dia, Mediana, Moda)

# M√©dia, mediana e moda de vari√°veis num√©ricas
media = df.mean(numeric_only=True)
mediana = df.median(numeric_only=True)
moda = df.mode().iloc[0]

# Formata√ß√£o das medidas de tend√™ncia central para melhor legibilidade
print("M√©dia:\n", media.to_string())
print("\nMediana:\n", mediana.to_string())
print("\nModa:\n", moda.to_string())

# Texto explicativo
texto16 = (
    "A an√°lise estat√≠stica apresentada oferece uma vis√£o abrangente das caracter√≠sticas do conjunto de dados, abrangendo medidas de tend√™ncia central (m√©dia, mediana e moda) e "
    "dispers√£o (desvio padr√£o). A idade m√©dia dos pacientes √© de 54 anos, com uma distribui√ß√£o sim√©trica, enquanto o tempo m√©dio para recorr√™ncia √© de aproximadamente 29.5 meses. "
    "A maioria dos pacientes foi diagnosticada no est√°gio 2 do c√¢ncer, com tumores de agressividade m√©dia. A cobertura de seguro, o diagn√≥stico precoce e o acesso ao tratamento s√£o comuns "
    "na amostra. A quimioterapia √© mais frequente que a radioterapia. A moda revela que a maioria dos pacientes √© do sexo masculino, ra√ßa branca, da Am√©rica do Norte, residente em √°reas "
    "urbanas, de classe m√©dia, sem hist√≥rico familiar ou pr√©vio de c√¢ncer, com diagn√≥stico regular, dieta ocidental, baixo n√≠vel de atividade f√≠sica, nunca fumou, baixo consumo de √°lcool e "
    "carne vermelha, consumo m√©dio de fibras, cobertura de seguro, diagn√≥stico precoce, acesso ao tratamento, quimioterapia, cirurgia, boa ades√£o ao acompanhamento, sobrevida e sem recorr√™ncia."
    " O tempo mais frequente para recorr√™ncia √© de 53 meses."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto16, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

# 4) Medidas de Dispers√£o (Desvio Padr√£o e Intervalo Interquartil - IQR)

# Desvio padr√£o
desvio_padrao = df.std(numeric_only=True)

# Intervalo interquartil (IQR)
Q1 = df.quantile(0.25, numeric_only=True)
Q3 = df.quantile(0.75, numeric_only=True)
IQR = Q3 - Q1

# Formata√ß√£o das medidas de dispers√£o para melhor legibilidade
print("Desvio Padr√£o:\n", desvio_padrao.to_string())
print("\nIntervalo Interquartil (IQR):\n", IQR.to_string())

# Texto explicativo
texto17 = (
    "As medidas de dispers√£o fornecem informa√ß√µes sobre a variabilidade dos dados em rela√ß√£o √† m√©dia ou √† mediana. O desvio padr√£o mede a dispers√£o dos dados em torno da m√©dia, enquanto"
    " o intervalo interquartil (IQR) mede a dispers√£o dos dados em torno da mediana. Neste caso, observa-se que a vari√°vel 'Idade' (Age) apresenta o maior desvio padr√£o (20.18 anos) e o maior "
    "IQR (35 anos), indicando uma alta variabilidade na idade dos pacientes. A vari√°vel 'Tempo at√© a Recorr√™ncia' (Time_to_Recurrence) tamb√©m apresenta um desvio padr√£o "
    "consider√°vel (17.27 meses) e um IQR de 29 meses, sugerindo uma ampla varia√ß√£o no tempo at√© a recorr√™ncia do c√¢ncer. As demais vari√°veis, que s√£o categ√≥ricas bin√°rias (0 ou 1), "
    "apresentam desvios padr√£o pr√≥ximos de 0.5 e IQRs de 1 ou 0, indicando uma baixa variabilidade e uma distribui√ß√£o equilibrada entre as categorias. A an√°lise das medidas de dispers√£o "
    "pode auxiliar na identifica√ß√£o de vari√°veis com alta variabilidade, o que pode ter implica√ß√µes para a an√°lise dos dados e o desenvolvimento de modelos preditivos."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto17, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

# Moda das vari√°veis da categoria Diagn√≥stico, Caracter√≠sticas do C√¢ncer e Tratamento.
mode_values = df[["Stage_at_Diagnosis", "Tumor_Aggressiveness", "Insurance_Coverage",
                  "Time_to_Diagnosis", "Treatment_Access", "Chemotherapy_Received", "Radiotherapy_Received"]].mode().T

# Definindo nomes mais amig√°veis para as colunas
mode_values.columns = ["Modo (valor mais frequente)"]

# Exibindo de maneira mais leg√≠vel
print(mode_values)

# Inserindo um espa√ßo
print("\n")

# Texto a ser exibido
texto1 = (
    "O resultado da an√°lise da moda das vari√°veis relacionadas ao diagn√≥stico, caracter√≠sticas do c√¢ncer e tratamento revela os valores mais frequentes encontrados no conjunto de dados. "
    "A maioria dos pacientes foi diagnosticada no est√°gio 2 do c√¢ncer, com tumores de agressividade m√©dia (valor 2). A maioria possui cobertura de seguro de sa√∫de (valor 1), teve diagn√≥stico"
    " em um curto intervalo de tempo (valor 1) e acesso ao tratamento (valor 1). Al√©m disso, a maioria dos pacientes recebeu quimioterapia (valor 1), enquanto a maioria n√£o recebeu "
    "radioterapia (valor 0). Esses resultados refletem os padr√µes mais comuns entre os pacientes e podem auxiliar na defini√ß√£o de estrat√©gias de tratamento e acompanhamento"
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto1, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

"""**5) Respondendo as quest√µes de pesquisa relacionada √† categoria Diagn√≥stico, Caracter√≠sticas do C√¢ncer e Tratamento utilizando m√©todos de estat√≠stica:**"""

# Pergunta: Considerando os atributos relacionados √†s informa√ß√µes demogr√°ficas e ao diagn√≥stico e tratamento, qual o tratamento √© mais recomend√°vel?
# N√£o respondeu a quest√£o de pesquisa.

# Criar tabela cruzada entre est√°gio do c√¢ncer e tratamento recebido
crosstab = pd.crosstab(df["Stage_at_Diagnosis"], df["Chemotherapy_Received"])

# Formata√ß√£o da tabela cruzada para melhor legibilidade e adi√ß√£o de totais
crosstab['Total'] = crosstab.sum(axis=1)  # Adiciona total por est√°gio
crosstab.loc['Total'] = crosstab.sum(axis=0)  # Adiciona total por quimioterapia

# Teste Qui-quadrado para ver se h√° associa√ß√£o entre est√°gio do c√¢ncer e quimioterapia
chi2, p, _, _ = chi2_contingency(crosstab.iloc[:-1, :-1])  # Exclui totais do teste

# Gr√°fico de barras para tratamentos recebidos por est√°gio do c√¢ncer
plt.figure(figsize=(10, 8))  # Aumenta o tamanho da figura para melhor espa√ßamento
ax = sns.countplot(data=df, x="Stage_at_Diagnosis", hue="Chemotherapy_Received", palette="Set1")
plt.title("Quimioterapia Recebida por Est√°gio do C√¢ncer", fontsize=14, pad=20)  # Aumenta o espa√ßamento do t√≠tulo
plt.xlabel("Est√°gio do Diagn√≥stico", fontsize=12)
plt.ylabel("N√∫mero de Pacientes", fontsize=12)
plt.legend(title="Quimioterapia")
plt.xticks(ticks=[0, 1, 2, 3], labels=["I", "II", "III", "IV"], rotation=0)

# Adicionar valores de Stage_at_Diagnosis em cima de cada coluna (como n√∫meros inteiros)
for p in ax.patches:
    ax.annotate(f'{int(p.get_height())}', (p.get_x() + p.get_width() / 2., p.get_height()),
                ha='center', va='center', xytext=(0, 10), textcoords='offset points')

# Adicionar caixa de texto com valores poss√≠veis para Stage_at_Diagnosis
valores_possiveis_estagio = (
    "Valores Poss√≠veis para Est√°gio do Diagn√≥stico:\n"
    "I: Tumor localizado, sem dissemina√ß√£o\n"
    "II: Tumor invade tecidos pr√≥ximos\n"
    "III: Tumor com envolvimento significativo dos linfonodos\n"
    "IV: C√¢ncer metast√°tico (espalhado para √≥rg√£os distantes)"
)
plt.figtext(0.01, -0.28, valores_possiveis_estagio, ha="left", fontsize=10, bbox={"facecolor": "lightgray", "alpha": 0.5, "pad": 5})

# Adicionar caixa de texto com valores poss√≠veis para Quimioterapia_Received
valores_possiveis_quimioterapia = (
    "Valores Poss√≠veis para tratamento com quimioterapia:\n"
    "0: Paciente n√£o realizou quimioterapia\n"
    "1: Paciente realizou quimioterapia"
)
plt.figtext(0.01, -0.45, valores_possiveis_quimioterapia, ha="left", fontsize=10, bbox={"facecolor": "lightgray", "alpha": 0.5, "pad": 5})

plt.tight_layout(rect=[0, 0.03, 1, 0.75])  # Ajusta o layout para evitar sobreposi√ß√£o

plt.show()

# Texto explicativo
texto18 = (
    "O gr√°fico de barras acima exibe a rela√ß√£o entre o est√°gio do c√¢ncer no diagn√≥stico e o recebimento de quimioterapia pelos pacientes. "
    "Observa-se que a frequ√™ncia de pacientes que receberam quimioterapia (1) √© ligeiramente superior √† frequ√™ncia de pacientes que n√£o receberam (0) em todos os est√°gios do c√¢ncer. "
    "O teste Qui-quadrado, que avalia a associa√ß√£o entre as duas vari√°veis, resultou em um valor de X¬≤ de 2.74 e um p-valor de 0.4338. "
    "Como o p-valor √© superior a 0.05, n√£o h√° evid√™ncia estat√≠stica suficiente para rejeitar a hip√≥tese nula de que n√£o h√° associa√ß√£o entre o est√°gio do c√¢ncer e o recebimento de quimioterapia. "
    "Isso sugere que a decis√£o de administrar quimioterapia n√£o √© significativamente influenciada pelo est√°gio do c√¢ncer no diagn√≥stico, "
    "podendo ser determinada por outros fatores cl√≠nicos ou individuais do paciente. "
    "A an√°lise da rela√ß√£o entre o est√°gio do c√¢ncer e o tratamento recebido pode auxiliar na compreens√£o dos protocolos de tratamento adotados e no planejamento de estrat√©gias de interven√ß√£o."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto18, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)

# Pergunta: Considerando os atributos relacionados ao diagn√≥stico e tratamento, existe uma rela√ß√£o com o fato de o paciente ter se submetido ao exame de colonoscopia?
# N√£o respondeu a pergunta

# Certifique-se de que h√° uma coluna indicando se o paciente fez colonoscopia
if "Colonoscopy_Access" in df.columns:
    # Tabela cruzada entre colonoscopia e est√°gio do c√¢ncer
    colonoscopia_crosstab = pd.crosstab(df["Stage_at_Diagnosis"], df["Colonoscopy_Access"])

    # Teste Qui-quadrado
    chi2, p, _, _ = chi2_contingency(colonoscopia_crosstab)

    # Gr√°fico de barras
    plt.figure(figsize=(10, 8))  # Aumenta o tamanho da figura para melhor espa√ßamento
    ax = sns.countplot(data=df, x="Stage_at_Diagnosis", hue="Colonoscopy_Access", palette="Set1")
    plt.title("Colonoscopia realizada por est√°gio do c√¢ncer", fontsize=14, pad=20)  # Aumenta o espa√ßamento do t√≠tulo
    plt.xlabel("Est√°gio do Diagn√≥stico", fontsize=12)
    plt.ylabel("N√∫mero de Pacientes", fontsize=12)
    plt.legend(title="Colonoscopia")
    plt.xticks(ticks=[0, 1, 2, 3], labels=["I", "II", "III", "IV"], rotation=0)

    # Adicionar valores de Stage_at_Diagnosis em cima de cada coluna (como n√∫meros inteiros)
    for p in ax.patches:
        ax.annotate(f'{int(p.get_height())}', (p.get_x() + p.get_width() / 2., p.get_height()),
                    ha='center', va='center', xytext=(0, 10), textcoords='offset points')

    # Adicionar caixa de texto com valores poss√≠veis para Stage_at_Diagnosis
    valores_possiveis_estagio = (
        "Valores Poss√≠veis para Est√°gio do Diagn√≥stico:\n"
        "I: Tumor localizado, sem dissemina√ß√£o\n"
        "II: Tumor invade tecidos pr√≥ximos\n"
        "III: Tumor com envolvimento significativo dos linfonodos\n"
        "IV: C√¢ncer metast√°tico (espalhado para √≥rg√£os distantes)"
    )
    plt.figtext(0.01, -0.28, valores_possiveis_estagio, ha="left", fontsize=10, bbox={"facecolor": "lightgray", "alpha": 0.5, "pad": 5})

    # Adicionar caixa de texto com valores poss√≠veis para Colonoscopy_Access
    valores_possiveis_colonoscopia = (
        "Valores Poss√≠veis para Colonoscopia:\n"
        "Vermelho ou 0: Paciente n√£o realizou colonoscopia\n"
        "Azul ou 1: Paciente realizou colonoscopia"
    )
    plt.figtext(0.01, -0.45, valores_possiveis_colonoscopia, ha="left", fontsize=10, bbox={"facecolor": "lightgray", "alpha": 0.5, "pad": 5})

    plt.tight_layout(rect=[0, 0.03, 1, 0.75])  # Ajusta o layout para evitar sobreposi√ß√£o

    plt.show()

    # Texto explicativo
    texto19 = (
        "O gr√°fico de barras acima exibe a rela√ß√£o entre o est√°gio do c√¢ncer no diagn√≥stico e a realiza√ß√£o de colonoscopia pelos pacientes. "
        "Observa-se que a frequ√™ncia de pacientes que realizaram colonoscopia (1) √© consideravelmente superior √† frequ√™ncia de pacientes que n√£o realizaram (0) em todos os est√°gios do c√¢ncer. "
        "O teste Qui-quadrado, que avalia a associa√ß√£o entre as duas vari√°veis, resultou em um valor de X¬≤ de 1.90 e um p-valor de 0.5944. "
        "Como o p-valor √© superior a 0.05, n√£o h√° evid√™ncia estat√≠stica suficiente para rejeitar a hip√≥tese nula de que n√£o h√° associa√ß√£o entre o est√°gio do c√¢ncer e a realiza√ß√£o de colonoscopia. "
        "Isso sugere que a decis√£o de realizar colonoscopia n√£o √© significativamente influenciada pelo est√°gio do c√¢ncer no diagn√≥stico, "
        "podendo ser determinada por outros fatores cl√≠nicos ou individuais do paciente. "
        "A an√°lise da rela√ß√£o entre o est√°gio do c√¢ncer e a realiza√ß√£o de colonoscopia pode auxiliar na compreens√£o dos protocolos de rastreamento adotados e no planejamento de estrat√©gias de interven√ß√£o."
    )

    # Justifica√ß√£o do texto
    largura = 80  # Ajuste conforme necess√°rio
    texto_justificado = textwrap.fill(texto19, width=largura)

    # Impress√£o do texto justificado
    print("\nExplica√ß√£o dos Resultados:\n")
    print(texto_justificado)
else:
    print("‚ö†Ô∏è A coluna 'Colonoscopy_Access' n√£o est√° no dataset. Verifique os dados dispon√≠veis!")


import pandas as pd
import scipy.stats as stats

# Pergunta 1: Considerando os atributos relacionados ao diagn√≥stico e tratamento, existe uma rela√ß√£o com o fato de o paciente ter se submetido ao exame de colonoscopia?
# Teste Qui-Quadrado para Rela√ß√£o entre Fatores e Tratamento s√≥ com vari√°veis categ√≥ricas, por isso carreguei de novo o excel

# Defina o caminho correto para o arquivo no Google Colab
file_path = "c:/Users/gina_/OneDrive/√Årea de Trabalho/PUC/AULAS 7 SEMESTRE/Projeto/colorectal_cancer_prediction.xlsx"

# Carregar o dataset diretamente usando pandas
df = pd.read_excel(file_path, dtype=str)

# Definir vari√°veis categ√≥ricas a serem testadas
categorical_vars = ["Stage_at_Diagnosis", "Tumor_Aggressiveness", "Insurance_Coverage",
                    "Time_to_Diagnosis", "Treatment_Access", "Chemotherapy_Received", "Radiotherapy_Received"]

# Aplicar o teste qui-quadrado
for var in categorical_vars:
    table = pd.crosstab(df["Colonoscopy_Access"], df[var])
    chi2, p, dof, expected = stats.chi2_contingency(table)
    
    print(f"\nVari√°vel: {var}")
    print(f"Qui-Quadrado: {chi2:.4f}, p-valor: {p:.4f}")
    if p < 0.05:
        print("‚û° Associa√ß√£o significativa! üî•")
    else:
        print("‚ùå Nenhuma associa√ß√£o estat√≠stica.")

# Texto explicativo
texto20 = (
    "Com base nos resultados do teste Qui-Quadrado realizado, n√£o foi encontrada nenhuma associa√ß√£o estatisticamente significativa entre as vari√°veis de diagn√≥stico "
    "e tratamento analisadas (est√°gio do diagn√≥stico, agressividade do tumor, cobertura do seguro, tempo para o diagn√≥stico, acesso ao tratamento, quimioterapia recebida"
    " e radioterapia recebida) e o acesso √† colonoscopia. Isso significa que, dentro dos dados analisados, n√£o h√° evid√™ncias de que esses fatores influenciem a "
    "realiza√ß√£o do exame de colonoscopia. √â importante ressaltar que o teste Qui-Quadrado √© adequado para analisar a rela√ß√£o entre vari√°veis categ√≥ricas, e a aus√™ncia "
    "de signific√¢ncia estat√≠stica n√£o descarta a possibilidade de outras influ√™ncias n√£o consideradas na an√°lise."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto20, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)




# Pergunta 2: Pergunta: Considerando os atributos relacionados √†s informa√ß√µes demogr√°ficas e ao diagn√≥stico e tratamento, qual o tratamento √© mais recomend√°vel?
# Teste Qui-Quadrado para Rela√ß√£o entre Fatores e Tratamento s√≥ com vari√°veis categ√≥ricas, por isso carreguei de novo o excel

import scipy.stats as stats

# Defina o caminho correto para o arquivo no Google Colab
file_path = "c:/Users/gina_/OneDrive/√Årea de Trabalho/PUC/AULAS 7 SEMESTRE/Projeto/colorectal_cancer_prediction.xlsx"

# Carregar o dataset diretamente usando pandas
df = pd.read_excel(file_path, dtype=str)

# Lista de vari√°veis categ√≥ricas relevantes
categorical_vars = [
    "Gender", "Race", "Region", "Urban_or_Rural", "Socioeconomic_Status",
    "Family_History", "Previous_Cancer_History", "Stage_at_Diagnosis",
    "Tumor_Aggressiveness", "Insurance_Coverage", "Time_to_Diagnosis",
    "Treatment_Access"
]

# Analisando rela√ß√£o das vari√°veis com os tratamentos recomendados
treatments = ["Chemotherapy_Received", "Radiotherapy_Received"]

for treatment in treatments:
    print(f"\n===== Analisando {treatment} =====")
    
    for var in categorical_vars:
        table = pd.crosstab(df[treatment], df[var])
        chi2, p, dof, expected = stats.chi2_contingency(table)
        
        print(f"\nVari√°vel: {var}")
        print(f"Qui-Quadrado: {chi2:.4f}, p-valor: {p:.4f}")
        if p < 0.05:
            print("‚û° Associa√ß√£o significativa! üî•")
        else:
            print("‚ùå Nenhuma associa√ß√£o estat√≠stica.")

            # Texto explicativo
texto21 = (
    "Os resultados do teste Qui-Quadrado indicam que, ao analisar a influ√™ncia de fatores demogr√°ficos e de diagn√≥stico/tratamento na recomenda√ß√£o de quimioterapia, "
    "nenhuma das vari√°veis testadas mostrou associa√ß√£o estatisticamente significativa. No entanto, ao analisar a recomenda√ß√£o de radioterapia, a agressividade do "
    "tumor apresentou uma associa√ß√£o significativa, sugerindo que este fator pode influenciar a decis√£o de recomendar radioterapia. As demais vari√°veis n√£o mostraram "
    "rela√ß√£o estat√≠stica com a radioterapia. Assim, a agressividade do tumor parece ser um fator relevante na decis√£o de recomendar radioterapia, enquanto as outras"
    " vari√°veis analisadas n√£o demonstraram influ√™ncia significativa em nenhum dos tratamentos. √â importante notar que a aus√™ncia de signific√¢ncia estat√≠stica n√£o "
    "descarta a possibilidade de rela√ß√µes complexas e que outros fatores n√£o considerados na an√°lise podem influenciar as decis√µes de tratamento."
)

# Justifica√ß√£o do texto
largura = 80  # Ajuste conforme necess√°rio
texto_justificado = textwrap.fill(texto21, width=largura)

# Impress√£o do texto justificado
print("\nExplica√ß√£o dos Resultados:\n")
print(texto_justificado)